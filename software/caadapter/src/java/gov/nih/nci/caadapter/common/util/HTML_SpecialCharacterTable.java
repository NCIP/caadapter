package gov.nih.nci.caadapter.common.util;

import java.util.List;
import java.util.ArrayList;

/**
 * Created by IntelliJ IDEA.
 * User: umkis
 * Date: Apr 29, 2010
 * Time: 5:16:37 PM
 * To change this template use File | Settings | File Templates.
 */
public class HTML_SpecialCharacterTable
{
    List<Integer> numberTable = new ArrayList<Integer>();
    List<String> namedTable = new ArrayList<String>();

    public HTML_SpecialCharacterTable()
    {
        numberTable.add(new Integer(34));
        namedTable.add("&quot;");
        numberTable.add(new Integer(38));
        namedTable.add("&amp;");
        numberTable.add(new Integer(60));
        namedTable.add("&lt;");
        numberTable.add(new Integer(62));
        namedTable.add("&gt;");
        numberTable.add(new Integer(160));
        namedTable.add("&nbsp;");
        numberTable.add(new Integer(161));
        namedTable.add("&iexcl;");
        numberTable.add(new Integer(162));
        namedTable.add("&cent;");
        numberTable.add(new Integer(163));
        namedTable.add("&pound;");
        numberTable.add(new Integer(164));
        namedTable.add("&curren;");
        numberTable.add(new Integer(165));
        namedTable.add("&yen;");
        numberTable.add(new Integer(166));
        namedTable.add("&brvbar;");
        numberTable.add(new Integer(167));
        namedTable.add("&sect;");
        numberTable.add(new Integer(168));
        namedTable.add("&uml;");
        numberTable.add(new Integer(169));
        namedTable.add("&copy;");
        numberTable.add(new Integer(170));
        namedTable.add("&ordf;");
        numberTable.add(new Integer(171));
        namedTable.add("&laquo;");
        numberTable.add(new Integer(172));
        namedTable.add("&not;");
        numberTable.add(new Integer(173));
        namedTable.add("&shy;");
        numberTable.add(new Integer(174));
        namedTable.add("&reg;");
        numberTable.add(new Integer(175));
        namedTable.add("&macr;");

        numberTable.add(new Integer(176));
        namedTable.add("&deg;");

        numberTable.add(new Integer(177));
        namedTable.add("&plusmn;");

        numberTable.add(new Integer(178));
        namedTable.add("&sup2;");

        numberTable.add(new Integer(179));
        namedTable.add("&sup3;");

        numberTable.add(new Integer(180));
        namedTable.add("&acute;");

        numberTable.add(new Integer(181));
        namedTable.add("&micro;");

        numberTable.add(new Integer(182));
        namedTable.add("&para;");

        numberTable.add(new Integer(183));
        namedTable.add("&middot;");

        numberTable.add(new Integer(184));
        namedTable.add("&cedil;");

        numberTable.add(new Integer(185));
        namedTable.add("&sup1;");

        numberTable.add(new Integer(186));
        namedTable.add("&ordm;");

        numberTable.add(new Integer(187));
        namedTable.add("&raquo;");

        numberTable.add(new Integer(188));
        namedTable.add("&frac14;");

        numberTable.add(new Integer(189));
        namedTable.add("&frac12;");

        numberTable.add(new Integer(190));
        namedTable.add("&frac34;");

        numberTable.add(new Integer(191));
        namedTable.add("&iquest;");

        numberTable.add(new Integer(192));
        namedTable.add("&Agrave;");

        numberTable.add(new Integer(193));
        namedTable.add("&Aacute;");

        numberTable.add(new Integer(194));
        namedTable.add("&Acirc;");

        numberTable.add(new Integer(195));
        namedTable.add("&Atilde;");

        numberTable.add(new Integer(196));
        namedTable.add("&Auml;");

        numberTable.add(new Integer(197));
        namedTable.add("&Aring;");

        numberTable.add(new Integer(198));
        namedTable.add("&AElig;");

        numberTable.add(new Integer(199));
        namedTable.add("&Ccedil;");

        numberTable.add(new Integer(200));
        namedTable.add("&Egrave;");

        numberTable.add(new Integer(201));
        namedTable.add("&Eacute;");

        numberTable.add(new Integer(202));
        namedTable.add("&Ecirc;");

        numberTable.add(new Integer(203));
        namedTable.add("&Euml;");

        numberTable.add(new Integer(204));
        namedTable.add("&Igrave;");

        numberTable.add(new Integer(205));
        namedTable.add("&Iacute;");

        numberTable.add(new Integer(206));
        namedTable.add("&Icirc;");

        numberTable.add(new Integer(207));
        namedTable.add("&Iuml;");

        numberTable.add(new Integer(208));
        namedTable.add("&ETH;");

        numberTable.add(new Integer(209));
        namedTable.add("&Ntilde;");

        numberTable.add(new Integer(210));
        namedTable.add("&Ograve;");

        numberTable.add(new Integer(211));
        namedTable.add("&Oacute;");

        numberTable.add(new Integer(212));
        namedTable.add("&Ocirc;");

        numberTable.add(new Integer(213));
        namedTable.add("&Otilde;");

        numberTable.add(new Integer(214));
        namedTable.add("&Ouml;");

        numberTable.add(new Integer(215));
        namedTable.add("&times;");

        numberTable.add(new Integer(216));
        namedTable.add("&Oslash;");

        numberTable.add(new Integer(217));
        namedTable.add("&Ugrave;");

        numberTable.add(new Integer(218));
        namedTable.add("&Uacute;");

        numberTable.add(new Integer(219));
        namedTable.add("&Ucirc;");

        numberTable.add(new Integer(220));
        namedTable.add("&Uuml;");

        numberTable.add(new Integer(221));
        namedTable.add("&Yacute;");

        numberTable.add(new Integer(222));
        namedTable.add("&THORN;");

        numberTable.add(new Integer(223));
        namedTable.add("&szlig;");

        numberTable.add(new Integer(224));
        namedTable.add("&agrave;");

        numberTable.add(new Integer(225));
        namedTable.add("&aacute;");

        numberTable.add(new Integer(226));
        namedTable.add("&acirc;");

        numberTable.add(new Integer(227));
        namedTable.add("&atilde;");

        numberTable.add(new Integer(228));
        namedTable.add("&auml;");

        numberTable.add(new Integer(229));
        namedTable.add("&aring;");

        numberTable.add(new Integer(230));
        namedTable.add("&aelig;");

        numberTable.add(new Integer(231));
        namedTable.add("&ccedil;");

        numberTable.add(new Integer(232));
        namedTable.add("&egrave;");

        numberTable.add(new Integer(233));
        namedTable.add("&eacute;");

        numberTable.add(new Integer(234));
        namedTable.add("&ecirc;");

        numberTable.add(new Integer(235));
        namedTable.add("&euml;");

        numberTable.add(new Integer(236));
        namedTable.add("&igrave;");

        numberTable.add(new Integer(237));
        namedTable.add("&iacute;");

        numberTable.add(new Integer(238));
        namedTable.add("&icirc;");

        numberTable.add(new Integer(239));
        namedTable.add("&iuml;");

        numberTable.add(new Integer(240));
        namedTable.add("&eth;");

        numberTable.add(new Integer(241));
        namedTable.add("&ntilde;");

        numberTable.add(new Integer(242));
        namedTable.add("&ograve;");

        numberTable.add(new Integer(243));
        namedTable.add("&oacute;");

        numberTable.add(new Integer(244));
        namedTable.add("&ocirc;");

        numberTable.add(new Integer(245));
        namedTable.add("&otilde;");

        numberTable.add(new Integer(246));
        namedTable.add("&ouml;");

        numberTable.add(new Integer(247));
        namedTable.add("&divide;");

        numberTable.add(new Integer(248));
        namedTable.add("&oslash;");

        numberTable.add(new Integer(249));
        namedTable.add("&ugrave;");

        numberTable.add(new Integer(250));
        namedTable.add("&uacute;");

        numberTable.add(new Integer(251));
        namedTable.add("&ucirc;");

        numberTable.add(new Integer(252));
        namedTable.add("&uuml;");

        numberTable.add(new Integer(253));
        namedTable.add("&yacute;");

        numberTable.add(new Integer(254));
        namedTable.add("&thorn;");

        numberTable.add(new Integer(255));
        namedTable.add("&yuml;");
    }

    public String transformNamedCharacterToASCII(String str)
    {
        if ((str == null)||(str.trim().equals(""))) return null;
        str = str.trim();
        if (str.toLowerCase().equals("&amp;")) return "&";
        if (str.toLowerCase().startsWith("&amp;")) str = "&" + str.substring(5);
        if (!str.startsWith("&")) str = "&" + str;
        if (!str.endsWith(";")) str = str + ";";

        if (str.toLowerCase().equals("&space;")) return " ";
        if (str.toLowerCase().equals("&nbsp;")) return " ";
        if (str.toLowerCase().equals("&null;")) return "";
        if (str.toLowerCase().equals("&empty;")) return "";

        for (int i=0;i<namedTable.size();i++)
        {
            String named = namedTable.get(i);
            int number = -1;
            if (named.equals(str)) number = numberTable.get(i);
            if (number < 0)
            {
                int num2 = -1;
                if (named.equalsIgnoreCase(str)) num2 = numberTable.get(i);
                if ((num2 > 0)&&(num2 < 161)) number = num2;
            }

            if (number > 0) return transformIntegerToASCII(number);
        }
        return null;
    }

    public String transformIntegerToASCII(int num)
    {
        if ((num < 0)||(num > 255)) return null;
        byte bt = (byte) num;
        char chr = (char) bt;
        return "" + chr;
    }
    public String transformNumberStringToASCII(String str)
    {
        if ((str == null)||(str.trim().equals(""))) return null;
        str = str.trim();

        if (str.toLowerCase().startsWith("&amp;")) str = "&" + str.substring(5);
        if (str.startsWith("&"))
        {
            if (str.startsWith("&#")) str = str.substring(2);
            else return null;
            if (str.endsWith(";")) str = str.substring(0, str.length()-1);
            else return null;
        }
        int num = -1;
        try
        {
            num = Integer.parseInt(str);
        }
        catch(NumberFormatException ne)
        {
            return null;
        }
        return transformIntegerToASCII(num);
    }

    public String transformTaggingToString(String str)
    {
        if (str == null) return null;
        if (str.equals("")) return "";

        if (str.indexOf("&") < 0) return str;

        String line = "";
        String tagging = "";
        boolean isTag = false;

        char[] chars = str.toCharArray();
        for(char ch:chars)
        {
            String achar = "" + ch;
            if (achar.equals("&")) isTag = true;

            if (isTag)
            {
                tagging = tagging + achar;
                if (achar.equals(";"))
                {
                    String tr = transformNamedCharacterToASCII(tagging);
                    if (tr == null) tr = transformNumberStringToASCII(tagging);
                    if (tr == null) line = line + tagging;
                    else line = line + tr;
                    tagging = "";
                    isTag = false;
                }
            }
            else line = line + achar;
        }
        if (!tagging.equals("")) line = line + tagging;
        return line;
    }


}
