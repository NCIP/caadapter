<?xml version="1.0"?>
<project name="caadapter.demo" default="demo.zip" >
	<description>
					caAdapter: Demo
		************************************************************************** 
					caAdapter demo
		************************************************************************** 
	</description>	

	<path id="execution.class.path">
		<fileset dir="lib">
			<include name="**/*.jar"/>
			<include name="**/*.zip"/>
		</fileset>
	</path>

	<pathconvert pathsep=" " 
			targetos="unix" 
			property="distribution.manifest.class.property"
			refid="execution.class.path">
		<!-- make paths relative-->
		<map from="lib" to="./lib"/>
		<map from="${javasig}" to="."/>
		<map from="${basedir}" to="."/>
	</pathconvert>
	
	<target name="demo.zip"  depends="demo.ui.jar" >       
        <tstamp>
		       <format property="DATE" pattern="MM-dd-yy" locale="en_us"/>
        </tstamp>
        <zip destfile="caadapter4_0_Bin_${DATE}.zip">
			<zipfileset dir="." excludes="build.xml, *.war, *webstart/**, 
				lib/*.zip, lib/caadapterCommon.jar,	lib/caAdapter_ui.jar,
				lib/sqleonardo.jar, lib/ostermill*, lib/jgraph.jar,lib/junit*.jar" />
			<zipfileset dir=".." includes="docs/help/**, docs/v4.0/*.doc"
				excludes="docs/v4.0/*Scope*.doc"/>
		</zip>
    </target>

	<target name="demo.ui.jar"  depends="compile.demo" description="create the distribution jars">
		<!-- Create an executable jar that runs the UI.-->
		<echo message="${distribution.manifest.class.property}"/>
		<jar destfile="caAdapter_ui.jar">
			<fileset dir="../build" includes="**/LaunchUI.class"/>
			<manifest>
				<attribute name="Main-Class" value="gov.nih.nci.caadapter.hl7.demo.LaunchUI"/>
				<attribute name="Class-Path" value=". ./conf/ ${distribution.manifest.class.property}"/>
			</manifest>
		</jar>
	</target>

	<target name="ws.client.jar">
		<javac destdir="../build" 
			classpath="../demo/webServiceClient/axis.jar;../demo/webServiceClient/jaxrpc.jar"
			fork="yes" debug="on">
			<src path="../demo" />
			<include name="**/TestCaadapterWebservice.java"/>
		</javac>
		<jar destfile="caAdapter_ws_client.jar">
			<fileset dir="../build" includes="**/TestCaadapterWebservice.class"/>
		</jar>
	</target>
	
	<target name="compile.demo"  description="compile the source">
		<javac destdir="../build" 
				classpathref="execution.class.path"
				fork="yes" debug="on">
			<src path="../demo" />
			<include name="**/LaunchUI.java"/>
		</javac>
	</target>
	<target name="deploy.webstart"  description="deploy webstart components">
		 <copy todir="C:/devWeb/jboss-4.0.5.GA/server/default/deploy">
		      <fileset dir=".">
		           <include name="*.war"/>
		       </fileset>
        </copy>
	</target>
</project>
